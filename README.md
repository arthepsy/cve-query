CVE query
=========
Queries [H2](http://www.h2database.com/) CVE database generated by [OWASP Dependency-Check](https://www.owasp.org/index.php/OWASP_Dependency_Check).  
Can run with embedded or shared database.

Installation
------------
Note: it's preferred to use [RVM](http://rvm.io/).

    cd cve-query
    bundle install

Usage
-----

    Usage: cve-query [options] <command>
    
    Options:
        -d, --data <dir>                 database directory path
        -h, --host <host>                database host (default: "localhost")
        -p, --port <port>                database port (default: 9092)
        -n, --name <name>                database name (default: "dc")
            --properties <name>          database properties (default: ";MV_STORE=FALSE")
            --username <username>        username (default: "dcuser")
            --password <password>        password (default: "DC-Pass1337!")
    
            --help                       show help
    
    Commands:
        query <cpe>   			query for cpe (example: "activemq:5.8")
        server-cmd    			show database server start command


Eembedded mode
--------------

Find assigned CVE for ActiveMQ 5.8:

    ./cve-query.rb -d ~/bin/dependency-check/data/ query activemq:5.8

Shared mode
-----------

Download and extract H2 database software:

    curl -LO http://www.h2database.com/h2-2015-10-11.zip
    unzip h2-2015-10-11.zip

Show command how to start H2 database: 

    ./cve-query.rb -d ~/bin/dependency-check/data/ server-cmd

Run H2 database in shared mode _(will run in foreground)_:

    java -Dh2.bindAddress=localhost -cp `find ./ -name h2-*.jar` org.h2.tools.Server -tcp -tcpPort 9092 -baseDir ~/bin/dependency-check/data/

Find assigned CVE for ActiveMQ 5.8:

    ./cve-query.rb query activemq:5.8


Requirements
------------
* [JRuby](http://jruby.org/)
* [jdbc-h2](https://rubygems.org/gems/jdbc-h2)
* [H2](http://www.h2database.com/) _(only for running database in shared mode)_
